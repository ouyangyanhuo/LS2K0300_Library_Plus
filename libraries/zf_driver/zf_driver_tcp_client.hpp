#ifndef _ZF_DRIVER_TCP_CLIENT_HPP_
#define _ZF_DRIVER_TCP_CLIENT_HPP_

#include "zf_common_typedef.hpp"

class zf_driver_tcp_client
{
private:
    int                 m_socket;        // TCP套接字句柄
    struct sockaddr_in  m_server_addr;   // 服务器地址结构体
    int set_nonblocking(int fd);         // 设置非阻塞模式私有方法

    zf_driver_tcp_client(const zf_driver_tcp_client&) = delete;
    zf_driver_tcp_client& operator=(const zf_driver_tcp_client&) = delete;

public:
//-------------------------------------------------------------------------------------------------------------------
// 函数简介 构造函数
// 参数说明 无
// 返回参数 无
// 使用示例 zf_driver_tcp_client tcp_client;
// 备注信息 初始化套接字句柄为无效值，地址结构体内存清零初始化
//-------------------------------------------------------------------------------------------------------------------
    zf_driver_tcp_client(void);

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 析构函数
// 参数说明 无
// 返回参数 无
// 使用示例 自动调用，无需手动调用
// 备注信息 自动关闭已打开的套接字句柄，释放网络资源，防止句柄泄漏
//-------------------------------------------------------------------------------------------------------------------
    ~zf_driver_tcp_client(void);

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 TCP客户端初始化，创建套接字并连接服务器
// 参数说明 ip_addr  服务器IP地址字符串
// 参数说明 port     服务器TCP端口号
// 返回参数 int8     0-初始化连接成功  -1-初始化连接失败
// 使用示例 tcp_client.init("192.168.1.100", 8080);
// 备注信息 创建流式套接字，配置服务器地址，连接成功后设置为非阻塞模式
//-------------------------------------------------------------------------------------------------------------------
    int8 init(const char *ip_addr, uint32 port);

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 TCP发送数据
// 参数说明 buff    待发送数据缓冲区指针
// 参数说明 length  待发送数据的字节长度
// 返回参数 uint32  成功返回实际发送字节数  失败返回0
// 使用示例 tcp_client.send_data(send_buf, sizeof(send_buf));
// 备注信息 基于非阻塞套接字发送数据
//-------------------------------------------------------------------------------------------------------------------
    uint32 send_data(const uint8 *buff, uint32 length);

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 TCP读取数据
// 参数说明 buff    接收数据缓冲区指针
// 参数说明 length  最大接收的字节长度
// 返回参数 uint32  成功返回实际接收字节数  无数据返回0  错误返回-1
// 使用示例 tcp_client.read_data(recv_buf, sizeof(recv_buf));
// 备注信息 非阻塞模式读取，EAGAIN/EWOULDBLOCK为正常无数据状态
//-------------------------------------------------------------------------------------------------------------------
    uint32 read_data(uint8 *buff, uint32 length);

};

#endif