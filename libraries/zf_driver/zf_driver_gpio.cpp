#include "zf_driver_gpio.hpp"

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 构造函数
// 参数说明 path  GPIO设备文件路径
// 参数说明 flags 文件打开标志位
// 返回参数 无
// 使用示例 zf_driver_gpio gpio_obj("/dev/gpio_pin", O_RDWR);
// 备注信息 调用父类构造函数初始化文件句柄，无额外GPIO初始化逻辑
//-------------------------------------------------------------------------------------------------------------------
zf_driver_gpio::zf_driver_gpio(const char* path, int flags)
    : zf_driver_file_buffer(path, flags)
{
    // 空实现即可，GPIO无额外初始化逻辑
}

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 设置GPIO电平状态
// 参数说明 level  GPIO电平值 0-低电平  1-高电平
// 返回参数 无
// 使用示例 gpio_obj.set_level(1);
// 备注信息 数值转ASCII码写入设备文件，0->0x30,1->0x31
//-------------------------------------------------------------------------------------------------------------------
void zf_driver_gpio::set_level(uint8 level)
{
    level = level + 0x30;
    this->write_buff(&level, sizeof(uint8));
}

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 获取GPIO当前电平状态
// 参数说明 无
// 返回参数 uint8 GPIO电平值 0-低电平  1-高电平
// 使用示例 uint8 val = gpio_obj.get_level();
// 备注信息 从设备文件读取ASCII码并直接返回对应数值
//-------------------------------------------------------------------------------------------------------------------
uint8 zf_driver_gpio::get_level(void)
{
    uint8 level = 0;
    this->read_buff(&level, sizeof(uint8));
    return level;
}