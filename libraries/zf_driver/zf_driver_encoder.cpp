#include "zf_driver_encoder.hpp"

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 构造函数
// 参数说明 path  设备文件路径
// 参数说明 flags 文件打开标识位
// 返回参数 无
// 使用示例 zf_driver_encoder encoder_obj("/dev/encoder", O_RDWR);
// 备注信息 调用父类构造函数初始化文件句柄，默认打开方式为读写
//-------------------------------------------------------------------------------------------------------------------
zf_driver_encoder::zf_driver_encoder(const char* path, int flags)
    : zf_driver_file_buffer(path, flags)
{
    // 此处无额外逻辑，编码器初始化代码可后期在此添加
}

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 获取编码器计数值
// 参数说明 无
// 返回参数 int16 编码器当前计数值
// 使用示例 int16 cnt = encoder_obj.get_count();
// 备注信息 读取设备文件数据并转换为整型计数值
//-------------------------------------------------------------------------------------------------------------------
int16 zf_driver_encoder::get_count(void)
{
    int16 data = 0;
    this->read_buff((uint8*)&data, sizeof(data));
    return data;
}

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 清零编码器计数值
// 参数说明 无
// 返回参数 无
// 使用示例 encoder_obj.clear_count();
// 备注信息 向设备文件写入0值，完成编码器计数清零操作
//-------------------------------------------------------------------------------------------------------------------
void zf_driver_encoder::clear_count(void)
{
    int16 zero = 0;
    this->write_buff((uint8*)&zero, sizeof(zero));
}