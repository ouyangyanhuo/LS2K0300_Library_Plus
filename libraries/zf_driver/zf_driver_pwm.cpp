#include "zf_driver_pwm.hpp"

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 构造函数
// 参数说明 path  PWM设备文件路径
// 参数说明 flags 文件打开标志位
// 返回参数 无
// 使用示例 zf_driver_pwm pwm_obj("/dev/pwm", O_RDWR);
// 备注信息 调用父类构造函数初始化文件句柄，PWM无额外初始化逻辑
//-------------------------------------------------------------------------------------------------------------------
zf_driver_pwm::zf_driver_pwm(const char* path, int flags)
    : zf_driver_file_buffer(path, flags)
{
    // PWM无额外初始化逻辑，空实现即可
}

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 获取PWM设备信息数据
// 参数说明 pwm_info PWM信息结构体指针，用于存储读取的数据
// 返回参数 无
// 使用示例 struct pwm_info info; pwm_obj.get_dev_info(&info);
// 备注信息 二进制读取PWM设备信息，指针为空则不执行读取操作
//-------------------------------------------------------------------------------------------------------------------
void zf_driver_pwm::get_dev_info(pwm_info *pwm_info)
{
    if(NULL != pwm_info)
    {
        this->read_buff((uint8 *)pwm_info, sizeof(struct pwm_info));
    }
}

//-------------------------------------------------------------------------------------------------------------------
// 函数简介 设置PWM输出占空比值
// 参数说明 duty  PWM占空比值，数据类型uint16
// 返回参数 无
// 使用示例 pwm_obj.set_duty(500);
// 备注信息 二进制写入占空比数值到PWM设备文件，直接控制输出占空比
//-------------------------------------------------------------------------------------------------------------------
void zf_driver_pwm::set_duty(uint16 duty)
{
    this->write_buff((uint8 *)&duty, sizeof(uint16));
}